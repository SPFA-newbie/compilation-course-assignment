## 词法设计
**总体：基于C89，类似C语言**

#### 保留字

###### 数据类型

- 整数：short（16位）`后缀s`、int（32位），long（64位）`后缀l`
- 浮点数：float（对应float）`后缀f`、double（对应double）
- 字符（串）：char（8位）`不允许直接赋给数字`、string（对应string）
- 无类型：void

###### 语法模块

- 分支：if、then、else
- 循环：for、while
- 流程控制：continue、break
- 其他：const、return、*var*

#### 运算符

- 位运算（只能对整数进行）：`&`且、`|`或、`!`非、`^`异或
- 数运算（整数和浮点数）：`+`、`-`、`*`、`%`、`/`、`$`（作负号使用）
- 逻辑运算（最后一位为0 = false）：`&&`逻辑且、`||`逻辑或
- 比较运算：`>`、`<`、`==`、`!=`、`<=`、`>=`
- 赋值运算：`=`
- 引号：`'`、`"` **不出现在符号表中**
- 括号：`()`函数传值以及改变运算顺序、`[]`数组、`{}`语法块
- 分隔符：`;`语句结束、`,`变量分隔

#### 转义符

| 转义符 | 含义       | **ASCII**码值（十进制） |
| ------ | ---------- | ----------------------- |
| \\0    | 空字符     | 0                       |
| \\t    | 水平制表符 | 9                       |
| \\n    | 换行符     | 10                      |
| \\"    | 双引号     | 34                      |
| \\'    | 单引号     | 39                      |
| \\\\   | 反斜线     | 92                      |



#### 简化部分

- 只支持十进制数字输入，不能使用科学计数法
- 特化的负号
- 常数不能使用`-MAX_CONST-1`
- 不支持注释
- 单（双）引号的转义是必须的，即使它位于字符串（字符）中

> 补丁：
>
> - 新增加了保留字var用于声明变量

## 语法设计

#### 文法

- <程序> → { <函数> } { <声明语句> }  <主函数>
- <函数> → <返回值类型> <函数名> `LEFT_PARE` [<参数表>] `RIGHT_PARE` <代码块>
- <返回值类型> → `<TYPE_DEF>`
- <函数名> → `<CUS_NAME>`
- <参数表> → `<TYPE_DEF>` <参数名> { `COMMA` `<TYPE_DEF>` <参数名> }
- <参数名> → `<CUS_NAME>`
- <主函数> → <代码块>
- <代码块> → `LEFT_BRA` <语句>|<声明> {  <语句>|<声明>  } `RIGHT_BRA`
- <声明> → `CONST`|`VAR`  `<TYPE_DEF>`  `<CUS_NAME>`  `ASSIGN`  <表达式> `END`
- <函数调用> → <函数名> `LEFT_PARE` [ <表达式> { `COMMA` <表达式> } ] `RIGHT_PARE`
- <语句> → <赋值语句>|<while语句>|<for语句>|<if语句>|<代码块>|<函数调用语句>|<返回语句>|<空>  
- <赋值语句> → <变量名> `ASSIGN` <表达式> `END`
- <while语句> → `WHILE` `LEFT_PARE` <条件> `RIGHT_PARE` <语句>
- <for语句> → `FOR` `LEFT_PARE` <条件> `END` <赋值语句> `RIGHT_PARE` <语句>
- <if语句> → `IF` <条件> `THEN` <语句> [ `ELSE` <语句> ]
- <函数调用语句> → <函数调用>  `END`
- <返回语句> → `RETURN` <表达式> `END`
- <变量名> → `<CUS_NAME>`
- <表达式> → <变量名>|`CONST_VAL`
- <表达式> → [ `NEG`|`NOT` ]  `LEFT_PARE` <表达式> ` RIGHT_PARE`
- <表达式> → <函数调用> 
- <表达式> → <表达式>  { `<SYMBOL>`*运算符*   <表达式> }
- <条件> →  `LEFT_PARE` <条件> `RIGHT_PARE`
- <条件> → <表达式>  `<SYMBOL>`*关系运算符*   <表达式> 
- <条件> → <条件> { `<SYMBOL>`*逻辑运算符*  <条件> }

*逻辑运算符只包括逻辑或、逻辑与*

表达式可能含有的符号：负号`NEG`、非运算`NOT`、乘法`MUL`、除法`DIV`、取余`MOD`、加法`ADD`、减法`SUB`、按位与`AND`、按位异或`XOR`、按位或`OR`、左小括号`LEFT_PARE`、右小括号`RIGHT_PARE`

#### 运算符优先级

*表中只有算数运算符、位运算符和逻辑运算符，不包含等号、关系运算符和括号*

| 优先级（小标号先运算，为高优先级） | 运算符                          |
| ---------------------------------- | ------------------------------- |
| 1                                  | 负号`NEG`、非运算`NOT`          |
| 2                                  | 乘法`MUL`、除法`DIV`、取余`MOD` |
| 3                                  | 加法`ADD`、减法`SUB`            |
| 4                                  | 按位与`AND`                     |
| 5                                  | 按位异或`XOR`                   |
| 6                                  | 按位或`OR`                      |
| 7                                  | 逻辑与`LOG_AND`                 |
| 8                                  | 逻辑或`LOG_OR`                  |

#### 简化部分

- 函数只能传入形参
- 不支持指针
- **使用负号或非运算时必须使用括号**，例如`!(a)`、`$(120)`
- **一个声明语句中只能声明一个常量或变量**
- 表达式中不能出现逻辑运算符（逻辑或、逻辑与）和关系运算符
- 条件必须是比较运算（即必须含有关系运算符）
- 不支持数组的使用（虽然定义了数组标识符）
- 暂时不支持continue、break语句（虽然进行了定义）
- 不允许出现孤立的条件
- 不能连写比较，例如`a!=b!=c`是非法的
- **条件中不允许使用非运算**，因为非运算可以通过更换关系运算符实现
- 编译器不能从语法上检测函数是否出现了无返回值错误
- 函数声明与实现不能分离
- 在for循环中，计数器变化的语句后需要一个分号，即`for(i==100;i=i+1;)`
- 参数的类型一致性在运行时检查

